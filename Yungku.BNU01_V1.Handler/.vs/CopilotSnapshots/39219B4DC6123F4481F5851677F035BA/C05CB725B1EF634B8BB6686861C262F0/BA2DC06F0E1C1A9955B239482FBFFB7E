using System;
using System.Drawing;
using System.Windows.Forms;
using YungkuSystem.Globalization;

namespace Yungku.BNU01_V1.Handler.Pages
{
    /// <summary>
    /// FormAuto的统计功能扩展部分
    /// </summary>
    public partial class FormAuto
    {
        // 左右工位统计数据
        private int leftStationTotal = 0;
        private int leftStationPass = 0;
        private int leftStationFail = 0;
    private int rightStationTotal = 0;
        private int rightStationPass = 0;
   private int rightStationFail = 0;

        // 统计UI控件
   private Panel panelStatistics;
   private GroupBox gbLeftStationStats, gbRightStationStats, gbSystemStatus;
        private Label lblLeftTotal, lblLeftTotalValue;
        private Label lblLeftPass, lblLeftPassValue;
        private Label lblLeftFail, lblLeftFailValue;
        private Label lblLeftYield, lblLeftYieldValue;
  private Label lblRightTotal, lblRightTotalValue;
        private Label lblRightPass, lblRightPassValue;
      private Label lblRightFail, lblRightFailValue;
        private Label lblRightYield, lblRightYieldValue;
        
     // 右键菜单
        private ContextMenuStrip cmsStatsLeft;
 private ContextMenuStrip cmsStatsRight;

        /// <summary>
        /// 初始化统计面板 - 优化布局版本
        /// </summary>
        private void InitializeStatisticsPanel()
        {
   // 创建主统计面板
     panelStatistics = new Panel
            {
  BackColor = Color.FromArgb(45, 45, 45),
   Dock = DockStyle.Fill,
    Padding = new Padding(5)
 };

            // 创建左工位右键菜单
  CreateLeftStationContextMenu();
            
// 创建右工位右键菜单
            CreateRightStationContextMenu();

       // 创建左工位统计分组框
     gbLeftStationStats = new GroupBox
   {
  Text = G.Text("左工位统计"),
           ForeColor = Color.White,
    Font = new Font("微软雅黑", 10F, FontStyle.Bold),
         Location = new Point(5, 5),
       Size = new Size(347, 170),
        BackColor = Color.FromArgb(50, 50, 50),
                ContextMenuStrip = cmsStatsLeft
};

      // 创建右工位统计分组框
   gbRightStationStats = new GroupBox
   {
     Text = G.Text("右工位统计"),
     ForeColor = Color.White,
    Font = new Font("微软雅黑", 10F, FontStyle.Bold),
Location = new Point(5, 180),
     Size = new Size(347, 170),
       BackColor = Color.FromArgb(50, 50, 50),
    ContextMenuStrip = cmsStatsRight
     };

            // 创建系统状态分组框（移到底部，只包含MES和加密狗）
  gbSystemStatus = new GroupBox
   {
     Text = G.Text("系统状态"),
      ForeColor = Color.White,
       Font = new Font("微软雅黑", 10F, FontStyle.Bold),
  Location = new Point(5, 360),
    Size = new Size(347, 80),
      BackColor = Color.FromArgb(50, 50, 50)
   };

            // 初始化左工位统计标签
  InitializeStationLabels(gbLeftStationStats, 
out lblLeftTotal, out lblLeftTotalValue,
 out lblLeftPass, out lblLeftPassValue,
      out lblLeftFail, out lblLeftFailValue,
       out lblLeftYield, out lblLeftYieldValue);

        // 初始化右工位统计标签
       InitializeStationLabels(gbRightStationStats,
  out lblRightTotal, out lblRightTotalValue,
     out lblRightPass, out lblRightPassValue,
     out lblRightFail, out lblRightFailValue,
        out lblRightYield, out lblRightYieldValue);

         // 添加控件到面板
    panelStatistics.Controls.Add(gbLeftStationStats);
            panelStatistics.Controls.Add(gbRightStationStats);
       panelStatistics.Controls.Add(gbSystemStatus);
        }

        /// <summary>
        /// 创建左工位右键菜单
     /// </summary>
        private void CreateLeftStationContextMenu()
        {
            cmsStatsLeft = new ContextMenuStrip();
            
         ToolStripMenuItem tsmiClearLeft = new ToolStripMenuItem
       {
       Text = G.Text("清空左工位统计"),
            BackColor = Color.FromArgb(255, 128, 0),
          ForeColor = Color.FromArgb(0, 0, 192)
            };
    tsmiClearLeft.Click += ClearLeftStationStats;
            
            ToolStripMenuItem tsmiClearAll = new ToolStripMenuItem
      {
       Text = G.Text("清空全部统计"),
    BackColor = Color.Yellow,
           ForeColor = Color.Red
            };
         tsmiClearAll.Click += ClearAllStationStats;
    
            cmsStatsLeft.Items.Add(tsmiClearLeft);
  cmsStatsLeft.Items.Add(new ToolStripSeparator());
   cmsStatsLeft.Items.Add(tsmiClearAll);
        }
        
        /// <summary>
        /// 创建右工位右键菜单
        /// </summary>
        private void CreateRightStationContextMenu()
        {
     cmsStatsRight = new ContextMenuStrip();
            
   ToolStripMenuItem tsmiClearRight = new ToolStripMenuItem
  {
      Text = G.Text("清空右工位统计"),
         BackColor = Color.FromArgb(255, 128, 0),
       ForeColor = Color.FromArgb(0, 0, 192)
};
     tsmiClearRight.Click += ClearRightStationStats;
        
            ToolStripMenuItem tsmiClearAll = new ToolStripMenuItem
            {
          Text = G.Text("清空全部统计"),
  BackColor = Color.Yellow,
         ForeColor = Color.Red
            };
          tsmiClearAll.Click += ClearAllStationStats;
   
            cmsStatsRight.Items.Add(tsmiClearRight);
       cmsStatsRight.Items.Add(new ToolStripSeparator());
   cmsStatsRight.Items.Add(tsmiClearAll);
        }
